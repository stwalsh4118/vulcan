# [3-7] Workload Detail Page

[Back to task list](./tasks.md)

## Description

Build the workload detail page at `/workloads/[id]` showing full workload information including status, output, error, duration, isolation mode, and timestamps. Includes auto-polling for status updates while the workload is active.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-19 05:13:20 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-19 05:37:00 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-19 05:38:11 | Status Change | InProgress | Review | Implementation complete, internal AI review passed | AI_Agent |
| 2026-02-19 06:18:27 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

1. Route: `/workloads/[id]` (dynamic route).
2. Display all workload fields:
   - Status with color-coded badge
   - Runtime and isolation mode
   - Output (preformatted text block)
   - Error message (if any, styled as error)
   - Exit code
   - Duration (formatted from `duration_ms`)
   - Timestamps: created, started, finished (formatted)
   - Node ID
3. Auto-polling: use React Query `refetchInterval` to poll `GET /v1/workloads/:id` while status is `pending` or `running`. Stop polling on terminal states.
4. Kill button: for active workloads (pending/running), show a "Kill" button that calls `DELETE /v1/workloads/:id`.
5. 404 handling: show error state if workload not found.
6. Log streaming placeholder area (actual SSE integration in task 3-8).

## Implementation Plan

1. Create `web/src/app/workloads/[id]/page.tsx` — detail page.
2. Use `useWorkload(id)` hook with conditional `refreshInterval` (e.g., 2s while active, 0 when terminal).
3. Build detail sections: header with status badge, info grid, output block, error block.
4. Add kill button with confirmation and `deleteWorkload(id)` call.
5. Add placeholder section for log stream (populated in task 3-8).
6. Format timestamps and duration for display.
7. Handle loading and 404 states.

## Test Plan

- Page renders all workload fields correctly.
- Status badge shows correct color for each status.
- Output displays in a preformatted block.
- Error section appears only when error is present.
- Kill button appears for active workloads, hidden for terminal states.
- Polling activates for pending/running workloads and stops for terminal states.
- 404 state renders when workload not found.
- TypeScript compilation passes.

## Verification

- `pnpm build` succeeds with no errors.
- Page renders all workload fields (status, runtime, isolation, exit code, duration, timestamps, node ID).
- Status badge shows correct color for each status.
- Output displays in preformatted block; error section styled in red.
- Kill button appears for active workloads, hidden for terminal states.
- Polling activates for pending/running (via useWorkload hook), stops for terminal states.
- 404 state renders when workload not found.
- Log streaming placeholder present for task 3-8 integration.

## Files Modified

- `web/src/app/workloads/[id]/page.tsx` — workload detail page with info grid, output, error, kill, and log placeholder
